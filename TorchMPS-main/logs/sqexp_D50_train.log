Device: cuda
Prefix: sqexp_D50, max_degree=5, N_targets=10
LR=0.001, LR factor=0.8, LR patience=3, min_lr=1e-07, early_stop_patience=50
Grad clip: 1.0
Using N_base=10 base points out of 10, D=50
Using N_T_NODES=6 Chebyshev nodes in t for path augmentation.
Generating path-augmented dataset...
Path-augmented dataset size (h + g_i paths): 3060 points = (1 + D)*N_base*N_T_NODES

Training MPS on path-augmented regression
D=50 (original space), bond_dim=30, N_train=3060 (no held-out test set)

### Epoch 001 ###
Train MSE: 77066230.24758
Train R2 (on path-augmented data): 0.060654
Avg grad norm: 4732363502.6774 | LR: 1.00e-03
Best so far: epoch 1, MSE=77066230.24758, R²=0.060654, Improved | No improve count: 0/50
Runtime so far: 7 sec

### Epoch 002 ###
Train MSE: 57296353.39135
Train R2 (on path-augmented data): 0.277949
Avg grad norm: 3425498639.8230 | LR: 1.00e-03
Best so far: epoch 2, MSE=57296353.39135, R²=0.277949, Improved | No improve count: 0/50
Runtime so far: 17 sec

### Epoch 003 ###
Train MSE: 21038595.91681
Train R2 (on path-augmented data): 0.763102
Avg grad norm: 1315471154.0500 | LR: 1.00e-03
Best so far: epoch 3, MSE=21038595.91681, R²=0.763102, Improved | No improve count: 0/50
Runtime so far: 25 sec

### Epoch 004 ###
Train MSE: 22349767.11495
Train R2 (on path-augmented data): 0.511964
Avg grad norm: 1486847647.2127 | LR: 1.00e-03
Best so far: epoch 3, MSE=21038595.91681, R²=0.763102, No improve | No improve count: 1/50
Runtime so far: 32 sec

### Epoch 005 ###
Train MSE: 33470273.50376
Train R2 (on path-augmented data): 0.540969
Avg grad norm: 2273524004.9718 | LR: 1.00e-03
Best so far: epoch 3, MSE=21038595.91681, R²=0.763102, No improve | No improve count: 2/50
Runtime so far: 40 sec

### Epoch 006 ###
Train MSE: 15088829.94249
Train R2 (on path-augmented data): 0.774016
Avg grad norm: 1261778227.5856 | LR: 1.00e-03
Best so far: epoch 6, MSE=15088829.94249, R²=0.774016, Improved | No improve count: 0/50
Runtime so far: 48 sec

### Epoch 007 ###
Train MSE: 13898092.08747
Train R2 (on path-augmented data): 0.939769
Avg grad norm: 1126522308.2639 | LR: 1.00e-03
Best so far: epoch 7, MSE=13898092.08747, R²=0.939769, Improved | No improve count: 0/50
Runtime so far: 55 sec

### Epoch 008 ###
Train MSE: 9765896.25368
Train R2 (on path-augmented data): 0.796466
Avg grad norm: 780718673.3887 | LR: 1.00e-03
Best so far: epoch 7, MSE=13898092.08747, R²=0.939769, No improve | No improve count: 1/50
Runtime so far: 62 sec

### Epoch 009 ###
Train MSE: 10764344.42808
Train R2 (on path-augmented data): 0.012304
Avg grad norm: 913115277.9731 | LR: 1.00e-03
Best so far: epoch 7, MSE=13898092.08747, R²=0.939769, No improve | No improve count: 2/50
Runtime so far: 69 sec

### Epoch 010 ###
Train MSE: 6285929.07044
Train R2 (on path-augmented data): 0.782229
Avg grad norm: 717369829.2676 | LR: 1.00e-03
Best so far: epoch 7, MSE=13898092.08747, R²=0.939769, No improve | No improve count: 3/50
Runtime so far: 77 sec


Restored best MPS from epoch 7 (MSE=13898092.08747, R²=0.939769)
Saved TN-SHAP targets and t-nodes to sqexp_D50_tnshap_targets.pt
Saved trained MPS to sqexp_D50_mps.pt
Done.
