Device: cuda
Prefix: poly5_D50, max_degree=5, N_targets=10
LR=0.001, LR factor=0.8, LR patience=3, min_lr=1e-07, early_stop_patience=50
Grad clip: 1.0
Using N_base=10 base points out of 10, D=50
Using N_T_NODES=6 Chebyshev nodes in t for path augmentation.
Generating path-augmented dataset...
Path-augmented dataset size (h + g_i paths): 3060 points = (1 + D)*N_base*N_T_NODES

Training MPS on path-augmented regression
D=50 (original space), bond_dim=30, N_train=3060 (no held-out test set)

### Epoch 001 ###
Train MSE: 0.44675
Train R2 (on path-augmented data): 0.819750
Avg grad norm: 43.0985 | LR: 1.00e-03
Best so far: epoch 1, MSE=0.44675, R²=0.819750, Improved | No improve count: 0/50
Runtime so far: 7 sec

### Epoch 002 ###
Train MSE: 0.15990
Train R2 (on path-augmented data): 0.920840
Avg grad norm: 13.9015 | LR: 1.00e-03
Best so far: epoch 2, MSE=0.15990, R²=0.920840, Improved | No improve count: 0/50
Runtime so far: 14 sec

### Epoch 003 ###
Train MSE: 0.14102
Train R2 (on path-augmented data): 0.867853
Avg grad norm: 13.2005 | LR: 1.00e-03
Best so far: epoch 2, MSE=0.15990, R²=0.920840, No improve | No improve count: 1/50
Runtime so far: 22 sec

### Epoch 004 ###
Train MSE: 0.14175
Train R2 (on path-augmented data): 0.949605
Avg grad norm: 14.6922 | LR: 1.00e-03
Best so far: epoch 4, MSE=0.14175, R²=0.949605, Improved | No improve count: 0/50
Runtime so far: 29 sec

### Epoch 005 ###
Train MSE: 0.10399
Train R2 (on path-augmented data): 0.955966
Avg grad norm: 9.7324 | LR: 1.00e-03
Best so far: epoch 5, MSE=0.10399, R²=0.955966, Improved | No improve count: 0/50
Runtime so far: 36 sec

### Epoch 006 ###
Train MSE: 0.08864
Train R2 (on path-augmented data): 0.927993
Avg grad norm: 8.1708 | LR: 1.00e-03
Best so far: epoch 5, MSE=0.10399, R²=0.955966, No improve | No improve count: 1/50
Runtime so far: 44 sec

### Epoch 007 ###
Train MSE: 0.08706
Train R2 (on path-augmented data): 0.961721
Avg grad norm: 8.6339 | LR: 1.00e-03
Best so far: epoch 7, MSE=0.08706, R²=0.961721, Improved | No improve count: 0/50
Runtime so far: 51 sec

### Epoch 008 ###
Train MSE: 0.08228
Train R2 (on path-augmented data): 0.955522
Avg grad norm: 7.8112 | LR: 1.00e-03
Best so far: epoch 7, MSE=0.08706, R²=0.961721, No improve | No improve count: 1/50
Runtime so far: 58 sec

### Epoch 009 ###
Train MSE: 0.07596
Train R2 (on path-augmented data): 0.956312
Avg grad norm: 8.0120 | LR: 1.00e-03
Best so far: epoch 7, MSE=0.08706, R²=0.961721, No improve | No improve count: 2/50
Runtime so far: 66 sec

### Epoch 010 ###
Train MSE: 0.07937
Train R2 (on path-augmented data): 0.952139
Avg grad norm: 9.0903 | LR: 1.00e-03
Best so far: epoch 7, MSE=0.08706, R²=0.961721, No improve | No improve count: 3/50
Runtime so far: 73 sec


Restored best MPS from epoch 7 (MSE=0.08706, R²=0.961721)
Saved TN-SHAP targets and t-nodes to poly5_D50_tnshap_targets.pt
Saved trained MPS to poly5_D50_mps.pt
Done.
