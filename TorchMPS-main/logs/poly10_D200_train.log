Device: cuda
Prefix: poly10_D200, max_degree=10, N_targets=20
Using N_base=20 base points out of 20, D=200
Using N_T_NODES=11 Chebyshev nodes in t for path augmentation.
Generating path-augmented dataset...
Path-augmented dataset size (h + g_i paths): 44220 points = (1 + D)*N_base*N_T_NODES

Training MPS on path-augmented regression
D_aug=201, bond_dim=60, N_train=44220 (no held-out test set)

### Epoch 001 ###
Train MSE: 3.35834
Train R2 (on path-augmented data): 0.7148
Best so far: epoch 1, MSE=3.35834, R²=0.7148, Improved
Runtime so far: 17 sec

### Epoch 002 ###
Train MSE: 0.60322
Train R2 (on path-augmented data): 0.9419
Best so far: epoch 2, MSE=0.60322, R²=0.9419, Improved
Runtime so far: 35 sec

### Epoch 003 ###
Train MSE: 0.52258
Train R2 (on path-augmented data): 0.9488
Best so far: epoch 3, MSE=0.52258, R²=0.9488, Improved
Runtime so far: 52 sec

### Epoch 004 ###
Train MSE: 0.46625
Train R2 (on path-augmented data): 0.9711
Best so far: epoch 4, MSE=0.46625, R²=0.9711, Improved
Runtime so far: 70 sec

### Epoch 005 ###
Train MSE: 0.44668
Train R2 (on path-augmented data): 0.9729
Best so far: epoch 5, MSE=0.44668, R²=0.9729, Improved
Runtime so far: 87 sec

### Epoch 006 ###
Train MSE: 0.40936
Train R2 (on path-augmented data): 0.9726
Best so far: epoch 5, MSE=0.44668, R²=0.9729, No improve
Runtime so far: 105 sec

### Epoch 007 ###
Train MSE: 0.44462
Train R2 (on path-augmented data): 0.9524
Best so far: epoch 5, MSE=0.44668, R²=0.9729, No improve
Runtime so far: 122 sec

### Epoch 008 ###
Train MSE: 0.34497
Train R2 (on path-augmented data): 0.9504
Best so far: epoch 5, MSE=0.44668, R²=0.9729, No improve
Runtime so far: 140 sec

### Epoch 009 ###
Train MSE: 0.31139
Train R2 (on path-augmented data): 0.9617
Best so far: epoch 5, MSE=0.44668, R²=0.9729, No improve
Runtime so far: 157 sec

### Epoch 010 ###
Train MSE: 0.42189
Train R2 (on path-augmented data): 0.9658
Best so far: epoch 5, MSE=0.44668, R²=0.9729, No improve
Runtime so far: 175 sec

### Epoch 011 ###
Train MSE: 0.35044
Train R2 (on path-augmented data): 0.7787
Best so far: epoch 5, MSE=0.44668, R²=0.9729, No improve
Runtime so far: 192 sec


⚠️  Detected divergence (loss explosion).
Stopping at epoch 12. Restoring best model from epoch 5 (MSE=0.44668, R²=0.9729)

Restored best MPS from epoch 5 (MSE=0.44668, R²=0.9729)
Saved TN-SHAP targets and t-nodes to poly10_D200_tnshap_targets.pt
Saved trained MPS to poly10_D200_mps.pt
Done.
