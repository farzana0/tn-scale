Device: cuda
Prefix: poly10_D50, max_degree=5, N_targets=10
LR=0.001, LR factor=0.8, LR patience=3, min_lr=1e-07, early_stop_patience=50
Grad clip: 1.0
Using N_base=10 base points out of 10, D=50
Using N_T_NODES=6 Chebyshev nodes in t for path augmentation.
Generating path-augmented dataset...
Path-augmented dataset size (h + g_i paths): 3060 points = (1 + D)*N_base*N_T_NODES

Training MPS on path-augmented regression
D=50 (original space), bond_dim=30, N_train=3060 (no held-out test set)

### Epoch 001 ###
Train MSE: 0.76957
Train R2 (on path-augmented data): 0.743645
Avg grad norm: 66.9175 | LR: 1.00e-03
Best so far: epoch 1, MSE=0.76957, R²=0.743645, Improved | No improve count: 0/50
Runtime so far: 7 sec

### Epoch 002 ###
Train MSE: 0.33056
Train R2 (on path-augmented data): 0.763179
Avg grad norm: 28.4591 | LR: 1.00e-03
Best so far: epoch 2, MSE=0.33056, R²=0.763179, Improved | No improve count: 0/50
Runtime so far: 14 sec

### Epoch 003 ###
Train MSE: 0.20282
Train R2 (on path-augmented data): 0.800820
Avg grad norm: 16.3244 | LR: 1.00e-03
Best so far: epoch 3, MSE=0.20282, R²=0.800820, Improved | No improve count: 0/50
Runtime so far: 22 sec

### Epoch 004 ###
Train MSE: 0.17373
Train R2 (on path-augmented data): 0.839988
Avg grad norm: 12.4103 | LR: 1.00e-03
Best so far: epoch 4, MSE=0.17373, R²=0.839988, Improved | No improve count: 0/50
Runtime so far: 29 sec

### Epoch 005 ###
Train MSE: 0.17641
Train R2 (on path-augmented data): 0.754266
Avg grad norm: 16.4544 | LR: 1.00e-03
Best so far: epoch 4, MSE=0.17373, R²=0.839988, No improve | No improve count: 1/50
Runtime so far: 37 sec

### Epoch 006 ###
Train MSE: 0.15164
Train R2 (on path-augmented data): 0.859927
Avg grad norm: 12.6354 | LR: 1.00e-03
Best so far: epoch 6, MSE=0.15164, R²=0.859927, Improved | No improve count: 0/50
Runtime so far: 44 sec

### Epoch 007 ###
Train MSE: 0.13457
Train R2 (on path-augmented data): 0.894588
Avg grad norm: 11.1983 | LR: 1.00e-03
Best so far: epoch 7, MSE=0.13457, R²=0.894588, Improved | No improve count: 0/50
Runtime so far: 51 sec

### Epoch 008 ###
Train MSE: 0.13197
Train R2 (on path-augmented data): 0.899725
Avg grad norm: 9.9496 | LR: 1.00e-03
Best so far: epoch 8, MSE=0.13197, R²=0.899725, Improved | No improve count: 0/50
Runtime so far: 59 sec

### Epoch 009 ###
Train MSE: 0.12378
Train R2 (on path-augmented data): 0.893539
Avg grad norm: 9.3969 | LR: 1.00e-03
Best so far: epoch 8, MSE=0.13197, R²=0.899725, No improve | No improve count: 1/50
Runtime so far: 66 sec

### Epoch 010 ###
Train MSE: 0.12330
Train R2 (on path-augmented data): 0.863328
Avg grad norm: 9.7542 | LR: 1.00e-03
Best so far: epoch 8, MSE=0.13197, R²=0.899725, No improve | No improve count: 2/50
Runtime so far: 73 sec


Restored best MPS from epoch 8 (MSE=0.13197, R²=0.899725)
Saved TN-SHAP targets and t-nodes to poly10_D50_tnshap_targets.pt
Saved trained MPS to poly10_D50_mps.pt
Done.
