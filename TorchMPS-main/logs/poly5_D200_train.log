Device: cuda
Prefix: poly5_D200, max_degree=5, N_targets=20
Using N_base=20 base points out of 20, D=200
Using N_T_NODES=6 Chebyshev nodes in t for path augmentation.
Generating path-augmented dataset...
Path-augmented dataset size (h + g_i paths): 24120 points = (1 + D)*N_base*N_T_NODES

Training MPS on path-augmented regression
D_aug=201, bond_dim=60, N_train=24120 (no held-out test set)

### Epoch 001 ###
Train MSE: 41220896.10485
Train R2 (on path-augmented data): 0.8808
Best so far: epoch 1, MSE=41220896.10485, R²=0.8808, Improved
Runtime so far: 9 sec

### Epoch 002 ###
Train MSE: 0.32733
Train R2 (on path-augmented data): 0.9316
Best so far: epoch 2, MSE=0.32733, R²=0.9316, Improved
Runtime so far: 18 sec

### Epoch 003 ###
Train MSE: 0.28906
Train R2 (on path-augmented data): 0.9403
Best so far: epoch 3, MSE=0.28906, R²=0.9403, Improved
Runtime so far: 27 sec

### Epoch 004 ###
Train MSE: 0.20968
Train R2 (on path-augmented data): 0.9466
Best so far: epoch 4, MSE=0.20968, R²=0.9466, Improved
Runtime so far: 37 sec

### Epoch 005 ###
Train MSE: 0.19576
Train R2 (on path-augmented data): 0.9677
Best so far: epoch 5, MSE=0.19576, R²=0.9677, Improved
Runtime so far: 46 sec

### Epoch 006 ###
Train MSE: 0.25883
Train R2 (on path-augmented data): 0.9695
Best so far: epoch 6, MSE=0.25883, R²=0.9695, Improved
Runtime so far: 56 sec

### Epoch 007 ###
Train MSE: 0.28975
Train R2 (on path-augmented data): 0.9739
Best so far: epoch 7, MSE=0.28975, R²=0.9739, Improved
Runtime so far: 65 sec

### Epoch 008 ###
Train MSE: 0.14148
Train R2 (on path-augmented data): 0.9627
Best so far: epoch 7, MSE=0.28975, R²=0.9739, No improve
Runtime so far: 74 sec

### Epoch 009 ###
Train MSE: 0.18809
Train R2 (on path-augmented data): 0.9825
Best so far: epoch 9, MSE=0.18809, R²=0.9825, Improved
Runtime so far: 83 sec

### Epoch 010 ###
Train MSE: 0.15627
Train R2 (on path-augmented data): 0.9836
Best so far: epoch 10, MSE=0.15627, R²=0.9836, Improved
Runtime so far: 93 sec

### Epoch 011 ###
Train MSE: 0.16668
Train R2 (on path-augmented data): 0.9853
Best so far: epoch 11, MSE=0.16668, R²=0.9853, Improved
Runtime so far: 102 sec

### Epoch 012 ###
Train MSE: 0.12719
Train R2 (on path-augmented data): 0.9530
Best so far: epoch 11, MSE=0.16668, R²=0.9853, No improve
Runtime so far: 111 sec

### Epoch 013 ###
Train MSE: 0.13004
Train R2 (on path-augmented data): 0.9764
Best so far: epoch 11, MSE=0.16668, R²=0.9853, No improve
Runtime so far: 120 sec

### Epoch 014 ###
Train MSE: 0.13538
Train R2 (on path-augmented data): 0.9746
Best so far: epoch 11, MSE=0.16668, R²=0.9853, No improve
Runtime so far: 129 sec

### Epoch 015 ###
Train MSE: 0.16065
Train R2 (on path-augmented data): 0.9631
Best so far: epoch 11, MSE=0.16668, R²=0.9853, No improve
Runtime so far: 139 sec

### Epoch 016 ###
Train MSE: 0.16546
Train R2 (on path-augmented data): 0.9772
Best so far: epoch 11, MSE=0.16668, R²=0.9853, No improve
Runtime so far: 148 sec

### Epoch 017 ###
Train MSE: 0.12513
Train R2 (on path-augmented data): 0.9730
Best so far: epoch 11, MSE=0.16668, R²=0.9853, No improve
Runtime so far: 158 sec

### Epoch 018 ###
Train MSE: 0.14493
Train R2 (on path-augmented data): 0.9377
Best so far: epoch 11, MSE=0.16668, R²=0.9853, No improve
Runtime so far: 167 sec

### Epoch 019 ###
Train MSE: 0.17248
Train R2 (on path-augmented data): 0.9522
Best so far: epoch 11, MSE=0.16668, R²=0.9853, No improve
Runtime so far: 176 sec

### Epoch 020 ###
Train MSE: 0.18482
Train R2 (on path-augmented data): 0.8044
Best so far: epoch 11, MSE=0.16668, R²=0.9853, No improve
Runtime so far: 186 sec

### Epoch 021 ###
Train MSE: 0.16797
Train R2 (on path-augmented data): 0.9791
Best so far: epoch 11, MSE=0.16668, R²=0.9853, No improve
Runtime so far: 195 sec

### Epoch 022 ###
Train MSE: 0.11112
Train R2 (on path-augmented data): 0.9812
Best so far: epoch 11, MSE=0.16668, R²=0.9853, No improve
Runtime so far: 204 sec

### Epoch 023 ###
Train MSE: 0.11352
Train R2 (on path-augmented data): 0.9774
Best so far: epoch 11, MSE=0.16668, R²=0.9853, No improve
Runtime so far: 213 sec

### Epoch 024 ###
Train MSE: 0.10326
Train R2 (on path-augmented data): 0.9827
Best so far: epoch 11, MSE=0.16668, R²=0.9853, No improve
Runtime so far: 222 sec

### Epoch 025 ###
Train MSE: 0.15076
Train R2 (on path-augmented data): 0.9792
Best so far: epoch 11, MSE=0.16668, R²=0.9853, No improve
Runtime so far: 232 sec


⚠️  Detected divergence (loss explosion).
Stopping at epoch 26. Restoring best model from epoch 11 (MSE=0.16668, R²=0.9853)

Restored best MPS from epoch 11 (MSE=0.16668, R²=0.9853)
Saved TN-SHAP targets and t-nodes to poly5_D200_tnshap_targets.pt
Saved trained MPS to poly5_D200_mps.pt
Done.
