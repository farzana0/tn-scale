Device: cuda
Prefix: poly10_D100
Batch size: 100, Num epochs: 20
Bond dim: 60, LR: 0.0001, L2: 0.0

Base points: N_base_total=105, using N_base=100, D=100
Using N_T_NODES=11 Chebyshev nodes in t for path augmentation.
Feature map: poly10_x2_then_one

Path-augmented dataset size (h + g_i paths): 111100 points = (1 + D)*N_base*N_T_NODES
Feature-space dim D_aug=200

Training MPS on path-augmented regression
N_train=111100, D_aug=200, bond_dim=60
LR=0.0001, L2=0.0
Early stopping patience=50, LR patience=20, factor=0.5

### Epoch 001 ###
Train MSE (normalized y): 6.943203e+00 | R²: 0.123052
Avg grad norm: 1856.7114 | LR: 1.00e-04
Best R²: 0.123052 (epoch 1) | No improve: 0/50
Runtime so far: 30 sec

### Epoch 002 ###
Train MSE (normalized y): 1.986825e+00 | R²: -4.458743
Avg grad norm: 419.3375 | LR: 1.00e-04
Best R²: 0.123052 (epoch 1) | No improve: 1/50
Runtime so far: 60 sec

### Epoch 003 ###
Train MSE (normalized y): 9.281404e-01 | R²: -5.057092
Avg grad norm: 82.6913 | LR: 1.00e-04
Best R²: 0.123052 (epoch 1) | No improve: 2/50
Runtime so far: 91 sec

### Epoch 004 ###
Train MSE (normalized y): 9.941998e-01 | R²: -0.688511
Avg grad norm: 102.4633 | LR: 1.00e-04
Best R²: 0.123052 (epoch 1) | No improve: 3/50
Runtime so far: 121 sec

### Epoch 005 ###
Train MSE (normalized y): 7.662282e+01 | R²: -0.151903
Avg grad norm: 17287.6272 | LR: 1.00e-04
Best R²: 0.123052 (epoch 1) | No improve: 4/50
Runtime so far: 152 sec

### Epoch 006 ###
Train MSE (normalized y): 4.930698e+00 | R²: -1.090158
Avg grad norm: 1017.9123 | LR: 1.00e-04
Best R²: 0.123052 (epoch 1) | No improve: 5/50
Runtime so far: 182 sec

### Epoch 007 ###
Train MSE (normalized y): 1.475945e+04 | R²: -1.165268
Avg grad norm: 3969484.8306 | LR: 1.00e-04
Best R²: 0.123052 (epoch 1) | No improve: 6/50
Runtime so far: 212 sec

### Epoch 008 ###
Train MSE (normalized y): 1.255289e+01 | R²: -0.328779
Avg grad norm: 2537.3158 | LR: 1.00e-04
Best R²: 0.123052 (epoch 1) | No improve: 7/50
Runtime so far: 243 sec

### Epoch 009 ###
Train MSE (normalized y): 6.705754e+00 | R²: -0.206974
Avg grad norm: 1510.0898 | LR: 1.00e-04
Best R²: 0.123052 (epoch 1) | No improve: 8/50
Runtime so far: 273 sec

### Epoch 010 ###
Train MSE (normalized y): 1.513541e+00 | R²: 0.098855
Avg grad norm: 286.3669 | LR: 1.00e-04
Best R²: 0.123052 (epoch 1) | No improve: 9/50
Runtime so far: 304 sec

### Epoch 011 ###
Train MSE (normalized y): 1.913567e+00 | R²: 0.203918
Avg grad norm: 350.6215 | LR: 1.00e-04
Best R²: 0.203918 (epoch 11) | No improve: 0/50
Runtime so far: 334 sec

### Epoch 012 ###
Train MSE (normalized y): 1.541602e+00 | R²: -1.308657
Avg grad norm: 327.9661 | LR: 1.00e-04
Best R²: 0.203918 (epoch 11) | No improve: 1/50
Runtime so far: 364 sec

### Epoch 013 ###
Train MSE (normalized y): 1.549486e+00 | R²: 0.084623
Avg grad norm: 257.8048 | LR: 1.00e-04
Best R²: 0.203918 (epoch 11) | No improve: 2/50
Runtime so far: 395 sec

### Epoch 014 ###
Train MSE (normalized y): 2.087990e+00 | R²: 0.274470
Avg grad norm: 367.2872 | LR: 1.00e-04
Best R²: 0.274470 (epoch 14) | No improve: 0/50
Runtime so far: 425 sec

### Epoch 015 ###
Train MSE (normalized y): 1.051434e+00 | R²: 0.286370
Avg grad norm: 130.8985 | LR: 1.00e-04
Best R²: 0.286370 (epoch 15) | No improve: 0/50
Runtime so far: 456 sec

### Epoch 016 ###
Train MSE (normalized y): 8.738353e-01 | R²: 0.349617
Avg grad norm: 118.1771 | LR: 1.00e-04
Best R²: 0.349617 (epoch 16) | No improve: 0/50
Runtime so far: 486 sec

### Epoch 017 ###
Train MSE (normalized y): 9.367324e-01 | R²: 0.216313
Avg grad norm: 138.5648 | LR: 1.00e-04
Best R²: 0.349617 (epoch 16) | No improve: 1/50
Runtime so far: 516 sec

### Epoch 018 ###
Train MSE (normalized y): 3.769333e+00 | R²: 0.333879
Avg grad norm: 832.9560 | LR: 1.00e-04
Best R²: 0.349617 (epoch 16) | No improve: 2/50
Runtime so far: 547 sec

### Epoch 019 ###
Train MSE (normalized y): 9.497790e-01 | R²: 0.401955
Avg grad norm: 186.0147 | LR: 1.00e-04
Best R²: 0.401955 (epoch 19) | No improve: 0/50
Runtime so far: 581 sec

### Epoch 020 ###
Train MSE (normalized y): 7.093054e-01 | R²: 0.106631
Avg grad norm: 136.2480 | LR: 1.00e-04
Best R²: 0.401955 (epoch 19) | No improve: 1/50
Runtime so far: 611 sec


✓ Training complete. Restoring best model from epoch 19 (R²=0.401955).
Saved TN-SHAP targets to poly10_D100_tnshap_targets.pt
Saved trained MPS to poly10_D100_mps.pt
Done.
