Device: cuda
Prefix: poly10_D100, max_degree=10, N_targets=20
Using N_base=20 base points out of 20, D=100
Using N_T_NODES=11 Chebyshev nodes in t for path augmentation.
Generating path-augmented dataset...
Path-augmented dataset size (h + g_i paths): 22220 points = (1 + D)*N_base*N_T_NODES

Training MPS on path-augmented regression
D_aug=101, bond_dim=60, N_train=22220 (no held-out test set)

### Epoch 001 ###
Train MSE: 172.69834
Train R2 (on path-augmented data): 0.9254
Best so far: epoch 1, MSE=172.69834, R²=0.9254, Improved
Runtime so far: 5 sec

### Epoch 002 ###
Train MSE: 0.31089
Train R2 (on path-augmented data): 0.8532
Best so far: epoch 1, MSE=172.69834, R²=0.9254, No improve
Runtime so far: 10 sec

### Epoch 003 ###
Train MSE: 0.21300
Train R2 (on path-augmented data): 0.9655
Best so far: epoch 3, MSE=0.21300, R²=0.9655, Improved
Runtime so far: 15 sec

### Epoch 004 ###
Train MSE: 0.18039
Train R2 (on path-augmented data): 0.9660
Best so far: epoch 4, MSE=0.18039, R²=0.9660, Improved
Runtime so far: 20 sec

### Epoch 005 ###
Train MSE: 0.19981
Train R2 (on path-augmented data): 0.9599
Best so far: epoch 4, MSE=0.18039, R²=0.9660, No improve
Runtime so far: 24 sec

### Epoch 006 ###
Train MSE: 0.16926
Train R2 (on path-augmented data): 0.9665
Best so far: epoch 6, MSE=0.16926, R²=0.9665, Improved
Runtime so far: 29 sec

### Epoch 007 ###
Train MSE: 0.14576
Train R2 (on path-augmented data): 0.9734
Best so far: epoch 7, MSE=0.14576, R²=0.9734, Improved
Runtime so far: 34 sec

### Epoch 008 ###
Train MSE: 0.15340
Train R2 (on path-augmented data): 0.9737
Best so far: epoch 8, MSE=0.15340, R²=0.9737, Improved
Runtime so far: 39 sec

### Epoch 009 ###
Train MSE: 0.10926
Train R2 (on path-augmented data): 0.9743
Best so far: epoch 9, MSE=0.10926, R²=0.9743, Improved
Runtime so far: 44 sec

### Epoch 010 ###
Train MSE: 0.12510
Train R2 (on path-augmented data): 0.9757
Best so far: epoch 10, MSE=0.12510, R²=0.9757, Improved
Runtime so far: 49 sec

### Epoch 011 ###
Train MSE: 0.11313
Train R2 (on path-augmented data): 0.9765
Best so far: epoch 11, MSE=0.11313, R²=0.9765, Improved
Runtime so far: 54 sec

### Epoch 012 ###
Train MSE: 0.12767
Train R2 (on path-augmented data): 0.9717
Best so far: epoch 11, MSE=0.11313, R²=0.9765, No improve
Runtime so far: 59 sec

### Epoch 013 ###
Train MSE: 0.11661
Train R2 (on path-augmented data): 0.9713
Best so far: epoch 11, MSE=0.11313, R²=0.9765, No improve
Runtime so far: 64 sec

### Epoch 014 ###
Train MSE: 0.10547
Train R2 (on path-augmented data): 0.9758
Best so far: epoch 11, MSE=0.11313, R²=0.9765, No improve
Runtime so far: 69 sec

### Epoch 015 ###
Train MSE: 0.11568
Train R2 (on path-augmented data): 0.9700
Best so far: epoch 11, MSE=0.11313, R²=0.9765, No improve
Runtime so far: 74 sec

### Epoch 016 ###
Train MSE: 0.10189
Train R2 (on path-augmented data): 0.9798
Best so far: epoch 16, MSE=0.10189, R²=0.9798, Improved
Runtime so far: 79 sec

### Epoch 017 ###
Train MSE: 0.12042
Train R2 (on path-augmented data): 0.9740
Best so far: epoch 16, MSE=0.10189, R²=0.9798, No improve
Runtime so far: 84 sec

### Epoch 018 ###
Train MSE: 0.09708
Train R2 (on path-augmented data): 0.9786
Best so far: epoch 16, MSE=0.10189, R²=0.9798, No improve
Runtime so far: 89 sec

### Epoch 019 ###
Train MSE: 0.09842
Train R2 (on path-augmented data): 0.9761
Best so far: epoch 16, MSE=0.10189, R²=0.9798, No improve
Runtime so far: 94 sec

### Epoch 020 ###
Train MSE: 0.09064
Train R2 (on path-augmented data): 0.9807
Best so far: epoch 20, MSE=0.09064, R²=0.9807, Improved
Runtime so far: 99 sec

### Epoch 021 ###
Train MSE: 0.10666
Train R2 (on path-augmented data): 0.9721
Best so far: epoch 20, MSE=0.09064, R²=0.9807, No improve
Runtime so far: 104 sec

### Epoch 022 ###
Train MSE: 0.09972
Train R2 (on path-augmented data): 0.9666
Best so far: epoch 20, MSE=0.09064, R²=0.9807, No improve
Runtime so far: 109 sec

### Epoch 023 ###
Train MSE: 0.09859
Train R2 (on path-augmented data): 0.9678
Best so far: epoch 20, MSE=0.09064, R²=0.9807, No improve
Runtime so far: 114 sec

### Epoch 024 ###
Train MSE: 0.11044
Train R2 (on path-augmented data): 0.9710
Best so far: epoch 20, MSE=0.09064, R²=0.9807, No improve
Runtime so far: 119 sec

### Epoch 025 ###
Train MSE: 0.09074
Train R2 (on path-augmented data): 0.9765
Best so far: epoch 20, MSE=0.09064, R²=0.9807, No improve
Runtime so far: 124 sec

### Epoch 026 ###
Train MSE: 0.08710
Train R2 (on path-augmented data): 0.9797
Best so far: epoch 20, MSE=0.09064, R²=0.9807, No improve
Runtime so far: 129 sec

### Epoch 027 ###
Train MSE: 0.09024
Train R2 (on path-augmented data): 0.9763
Best so far: epoch 20, MSE=0.09064, R²=0.9807, No improve
Runtime so far: 134 sec

### Epoch 028 ###
Train MSE: 0.11225
Train R2 (on path-augmented data): 0.9807
Best so far: epoch 28, MSE=0.11225, R²=0.9807, Improved
Runtime so far: 139 sec

### Epoch 029 ###
Train MSE: 0.10019
Train R2 (on path-augmented data): 0.9701
Best so far: epoch 28, MSE=0.11225, R²=0.9807, No improve
Runtime so far: 144 sec

### Epoch 030 ###
Train MSE: 0.09182
Train R2 (on path-augmented data): 0.9814
Best so far: epoch 30, MSE=0.09182, R²=0.9814, Improved
Runtime so far: 149 sec

### Epoch 031 ###
Train MSE: 0.08945
Train R2 (on path-augmented data): 0.9790
Best so far: epoch 30, MSE=0.09182, R²=0.9814, No improve
Runtime so far: 154 sec

### Epoch 032 ###
Train MSE: 0.08916
Train R2 (on path-augmented data): 0.9816
Best so far: epoch 32, MSE=0.08916, R²=0.9816, Improved
Runtime so far: 159 sec

### Epoch 033 ###
Train MSE: 0.10631
Train R2 (on path-augmented data): 0.9750
Best so far: epoch 32, MSE=0.08916, R²=0.9816, No improve
Runtime so far: 164 sec

### Epoch 034 ###
Train MSE: 0.09654
Train R2 (on path-augmented data): 0.9808
Best so far: epoch 32, MSE=0.08916, R²=0.9816, No improve
Runtime so far: 169 sec

### Epoch 035 ###
Train MSE: 0.08623
Train R2 (on path-augmented data): 0.9788
Best so far: epoch 32, MSE=0.08916, R²=0.9816, No improve
Runtime so far: 174 sec

### Epoch 036 ###
Train MSE: 3.70170
Train R2 (on path-augmented data): 0.8728
Best so far: epoch 32, MSE=0.08916, R²=0.9816, No improve
Runtime so far: 180 sec

### Epoch 037 ###
Train MSE: 0.18957
Train R2 (on path-augmented data): 0.9815
Best so far: epoch 32, MSE=0.08916, R²=0.9816, No improve
Runtime so far: 185 sec

### Epoch 038 ###
Train MSE: 0.09868
Train R2 (on path-augmented data): 0.9787
Best so far: epoch 32, MSE=0.08916, R²=0.9816, No improve
Runtime so far: 190 sec

### Epoch 039 ###
Train MSE: 0.10052
Train R2 (on path-augmented data): 0.9587
Best so far: epoch 32, MSE=0.08916, R²=0.9816, No improve
Runtime so far: 195 sec

### Epoch 040 ###
Train MSE: 0.09229
Train R2 (on path-augmented data): 0.9771
Best so far: epoch 32, MSE=0.08916, R²=0.9816, No improve
Runtime so far: 200 sec

### Epoch 041 ###
Train MSE: 0.08767
Train R2 (on path-augmented data): 0.9780
Best so far: epoch 32, MSE=0.08916, R²=0.9816, No improve
Runtime so far: 205 sec

### Epoch 042 ###
Train MSE: 0.08667
Train R2 (on path-augmented data): 0.9844
Best so far: epoch 42, MSE=0.08667, R²=0.9844, Improved
Runtime so far: 210 sec

### Epoch 043 ###
Train MSE: 0.10598
Train R2 (on path-augmented data): 0.9819
Best so far: epoch 42, MSE=0.08667, R²=0.9844, No improve
Runtime so far: 215 sec

### Epoch 044 ###
Train MSE: 0.09818
Train R2 (on path-augmented data): 0.9768
Best so far: epoch 42, MSE=0.08667, R²=0.9844, No improve
Runtime so far: 220 sec

### Epoch 045 ###
Train MSE: 0.09082
Train R2 (on path-augmented data): 0.9820
Best so far: epoch 42, MSE=0.08667, R²=0.9844, No improve
Runtime so far: 225 sec

### Epoch 046 ###
Train MSE: 0.08455
Train R2 (on path-augmented data): 0.9778
Best so far: epoch 42, MSE=0.08667, R²=0.9844, No improve
Runtime so far: 230 sec

### Epoch 047 ###
Train MSE: 0.08284
Train R2 (on path-augmented data): 0.9830
Best so far: epoch 42, MSE=0.08667, R²=0.9844, No improve
Runtime so far: 235 sec

### Epoch 048 ###
Train MSE: 0.11056
Train R2 (on path-augmented data): 0.9676
Best so far: epoch 42, MSE=0.08667, R²=0.9844, No improve
Runtime so far: 240 sec

### Epoch 049 ###
Train MSE: 0.09383
Train R2 (on path-augmented data): 0.9720
Best so far: epoch 42, MSE=0.08667, R²=0.9844, No improve
Runtime so far: 245 sec

### Epoch 050 ###
Train MSE: 0.08331
Train R2 (on path-augmented data): 0.9758
Best so far: epoch 42, MSE=0.08667, R²=0.9844, No improve
Runtime so far: 250 sec

### Epoch 051 ###
Train MSE: 0.08259
Train R2 (on path-augmented data): 0.9817
Best so far: epoch 42, MSE=0.08667, R²=0.9844, No improve
Runtime so far: 255 sec

### Epoch 052 ###
Train MSE: 0.08890
Train R2 (on path-augmented data): 0.9847
Best so far: epoch 52, MSE=0.08890, R²=0.9847, Improved
Runtime so far: 260 sec

### Epoch 053 ###
Train MSE: 0.08247
Train R2 (on path-augmented data): 0.9733
Best so far: epoch 52, MSE=0.08890, R²=0.9847, No improve
Runtime so far: 265 sec

### Epoch 054 ###
Train MSE: 0.08252
Train R2 (on path-augmented data): 0.9781
Best so far: epoch 52, MSE=0.08890, R²=0.9847, No improve
Runtime so far: 270 sec

### Epoch 055 ###
Train MSE: 0.08453
Train R2 (on path-augmented data): 0.9803
Best so far: epoch 52, MSE=0.08890, R²=0.9847, No improve
Runtime so far: 275 sec

### Epoch 056 ###
Train MSE: 0.08277
Train R2 (on path-augmented data): 0.9811
Best so far: epoch 52, MSE=0.08890, R²=0.9847, No improve
Runtime so far: 280 sec

### Epoch 057 ###
Train MSE: 0.08566
Train R2 (on path-augmented data): 0.9778
Best so far: epoch 52, MSE=0.08890, R²=0.9847, No improve
Runtime so far: 285 sec

### Epoch 058 ###
Train MSE: 0.08381
Train R2 (on path-augmented data): 0.9823
Best so far: epoch 52, MSE=0.08890, R²=0.9847, No improve
Runtime so far: 290 sec

### Epoch 059 ###
Train MSE: 0.08098
Train R2 (on path-augmented data): 0.9791
Best so far: epoch 52, MSE=0.08890, R²=0.9847, No improve
Runtime so far: 294 sec

### Epoch 060 ###
Train MSE: 0.09142
Train R2 (on path-augmented data): 0.9710
Best so far: epoch 52, MSE=0.08890, R²=0.9847, No improve
Runtime so far: 299 sec

### Epoch 061 ###
Train MSE: 0.08551
Train R2 (on path-augmented data): 0.9735
Best so far: epoch 52, MSE=0.08890, R²=0.9847, No improve
Runtime so far: 304 sec

### Epoch 062 ###
Train MSE: 0.08020
Train R2 (on path-augmented data): 0.9563
Best so far: epoch 52, MSE=0.08890, R²=0.9847, No improve
Runtime so far: 309 sec

### Epoch 063 ###
Train MSE: 0.09225
Train R2 (on path-augmented data): 0.9827
Best so far: epoch 52, MSE=0.08890, R²=0.9847, No improve
Runtime so far: 314 sec

### Epoch 064 ###
Train MSE: 0.08512
Train R2 (on path-augmented data): 0.9808
Best so far: epoch 52, MSE=0.08890, R²=0.9847, No improve
Runtime so far: 319 sec

### Epoch 065 ###
Train MSE: 0.14172
Train R2 (on path-augmented data): 0.9776
Best so far: epoch 52, MSE=0.08890, R²=0.9847, No improve
Runtime so far: 324 sec

### Epoch 066 ###
Train MSE: 0.09133
Train R2 (on path-augmented data): 0.9847
Best so far: epoch 66, MSE=0.09133, R²=0.9847, Improved
Runtime so far: 329 sec

### Epoch 067 ###
Train MSE: 0.07566
Train R2 (on path-augmented data): 0.9840
Best so far: epoch 66, MSE=0.09133, R²=0.9847, No improve
Runtime so far: 334 sec

### Epoch 068 ###
Train MSE: 0.07927
Train R2 (on path-augmented data): 0.9599
Best so far: epoch 66, MSE=0.09133, R²=0.9847, No improve
Runtime so far: 339 sec

### Epoch 069 ###
Train MSE: 0.07935
Train R2 (on path-augmented data): 0.9830
Best so far: epoch 66, MSE=0.09133, R²=0.9847, No improve
Runtime so far: 344 sec

### Epoch 070 ###
Train MSE: 0.09051
Train R2 (on path-augmented data): 0.9842
Best so far: epoch 66, MSE=0.09133, R²=0.9847, No improve
Runtime so far: 349 sec

### Epoch 071 ###
Train MSE: 0.08440
Train R2 (on path-augmented data): 0.9811
Best so far: epoch 66, MSE=0.09133, R²=0.9847, No improve
Runtime so far: 354 sec

### Epoch 072 ###
Train MSE: 0.07407
Train R2 (on path-augmented data): 0.9822
Best so far: epoch 66, MSE=0.09133, R²=0.9847, No improve
Runtime so far: 359 sec

### Epoch 073 ###
Train MSE: 0.07577
Train R2 (on path-augmented data): 0.9837
Best so far: epoch 66, MSE=0.09133, R²=0.9847, No improve
Runtime so far: 364 sec

### Epoch 074 ###
Train MSE: 0.08401
Train R2 (on path-augmented data): 0.9821
Best so far: epoch 66, MSE=0.09133, R²=0.9847, No improve
Runtime so far: 369 sec

### Epoch 075 ###
Train MSE: 0.08960
Train R2 (on path-augmented data): 0.9781
Best so far: epoch 66, MSE=0.09133, R²=0.9847, No improve
Runtime so far: 374 sec

### Epoch 076 ###
Train MSE: 0.07958
Train R2 (on path-augmented data): 0.9821
Best so far: epoch 66, MSE=0.09133, R²=0.9847, No improve
Runtime so far: 379 sec

### Epoch 077 ###
Train MSE: 0.07722
Train R2 (on path-augmented data): 0.9804
Best so far: epoch 66, MSE=0.09133, R²=0.9847, No improve
Runtime so far: 384 sec

### Epoch 078 ###
Train MSE: 0.08813
Train R2 (on path-augmented data): 0.9860
Best so far: epoch 78, MSE=0.08813, R²=0.9860, Improved
Runtime so far: 389 sec

### Epoch 079 ###
Train MSE: 0.07911
Train R2 (on path-augmented data): 0.9727
Best so far: epoch 78, MSE=0.08813, R²=0.9860, No improve
Runtime so far: 394 sec

### Epoch 080 ###
Train MSE: 0.10034
Train R2 (on path-augmented data): 0.9747
Best so far: epoch 78, MSE=0.08813, R²=0.9860, No improve
Runtime so far: 399 sec

### Epoch 081 ###
Train MSE: 0.07803
Train R2 (on path-augmented data): 0.9841
Best so far: epoch 78, MSE=0.08813, R²=0.9860, No improve
Runtime so far: 404 sec

### Epoch 082 ###
Train MSE: 0.07695
Train R2 (on path-augmented data): 0.9805
Best so far: epoch 78, MSE=0.08813, R²=0.9860, No improve
Runtime so far: 409 sec

### Epoch 083 ###
Train MSE: 0.08511
Train R2 (on path-augmented data): 0.9741
Best so far: epoch 78, MSE=0.08813, R²=0.9860, No improve
Runtime so far: 414 sec

### Epoch 084 ###
Train MSE: 0.08990
Train R2 (on path-augmented data): 0.9797
Best so far: epoch 78, MSE=0.08813, R²=0.9860, No improve
Runtime so far: 419 sec

### Epoch 085 ###
Train MSE: 0.08219
Train R2 (on path-augmented data): 0.9845
Best so far: epoch 78, MSE=0.08813, R²=0.9860, No improve
Runtime so far: 424 sec

### Epoch 086 ###
Train MSE: 0.07581
Train R2 (on path-augmented data): 0.9826
Best so far: epoch 78, MSE=0.08813, R²=0.9860, No improve
Runtime so far: 429 sec

### Epoch 087 ###
Train MSE: 0.07699
Train R2 (on path-augmented data): 0.9778
Best so far: epoch 78, MSE=0.08813, R²=0.9860, No improve
Runtime so far: 434 sec

### Epoch 088 ###
Train MSE: 0.07685
Train R2 (on path-augmented data): 0.9849
Best so far: epoch 78, MSE=0.08813, R²=0.9860, No improve
Runtime so far: 439 sec

### Epoch 089 ###
Train MSE: 0.06892
Train R2 (on path-augmented data): 0.9864
Best so far: epoch 89, MSE=0.06892, R²=0.9864, Improved
Runtime so far: 444 sec

### Epoch 090 ###
Train MSE: 0.07100
Train R2 (on path-augmented data): 0.9794
Best so far: epoch 89, MSE=0.06892, R²=0.9864, No improve
Runtime so far: 449 sec

### Epoch 091 ###
Train MSE: 0.09344
Train R2 (on path-augmented data): 0.9699
Best so far: epoch 89, MSE=0.06892, R²=0.9864, No improve
Runtime so far: 453 sec

### Epoch 092 ###
Train MSE: 0.11730
Train R2 (on path-augmented data): 0.9762
Best so far: epoch 89, MSE=0.06892, R²=0.9864, No improve
Runtime so far: 458 sec

### Epoch 093 ###
Train MSE: 0.08101
Train R2 (on path-augmented data): 0.9826
Best so far: epoch 89, MSE=0.06892, R²=0.9864, No improve
Runtime so far: 463 sec

### Epoch 094 ###
Train MSE: 0.07157
Train R2 (on path-augmented data): 0.9811
Best so far: epoch 89, MSE=0.06892, R²=0.9864, No improve
Runtime so far: 468 sec

### Epoch 095 ###
Train MSE: 0.07786
Train R2 (on path-augmented data): 0.9794
Best so far: epoch 89, MSE=0.06892, R²=0.9864, No improve
Runtime so far: 473 sec

### Epoch 096 ###
Train MSE: 0.07348
Train R2 (on path-augmented data): 0.9748
Best so far: epoch 89, MSE=0.06892, R²=0.9864, No improve
Runtime so far: 478 sec

### Epoch 097 ###
Train MSE: 0.08612
Train R2 (on path-augmented data): 0.9868
Best so far: epoch 97, MSE=0.08612, R²=0.9868, Improved
Runtime so far: 483 sec

### Epoch 098 ###
Train MSE: 0.08009
Train R2 (on path-augmented data): 0.9805
Best so far: epoch 97, MSE=0.08612, R²=0.9868, No improve
Runtime so far: 488 sec

### Epoch 099 ###
Train MSE: 0.08438
Train R2 (on path-augmented data): 0.9799
Best so far: epoch 97, MSE=0.08612, R²=0.9868, No improve
Runtime so far: 493 sec

### Epoch 100 ###
Train MSE: 0.07751
Train R2 (on path-augmented data): 0.9857
Best so far: epoch 97, MSE=0.08612, R²=0.9868, No improve
Runtime so far: 498 sec

### Epoch 101 ###
Train MSE: 0.07098
Train R2 (on path-augmented data): 0.9818
Best so far: epoch 97, MSE=0.08612, R²=0.9868, No improve
Runtime so far: 503 sec

### Epoch 102 ###
Train MSE: 0.06961
Train R2 (on path-augmented data): 0.9852
Best so far: epoch 97, MSE=0.08612, R²=0.9868, No improve
Runtime so far: 508 sec

### Epoch 103 ###
Train MSE: 0.07443
Train R2 (on path-augmented data): 0.9836
Best so far: epoch 97, MSE=0.08612, R²=0.9868, No improve
Runtime so far: 513 sec

### Epoch 104 ###
Train MSE: 0.08032
Train R2 (on path-augmented data): 0.9842
Best so far: epoch 97, MSE=0.08612, R²=0.9868, No improve
Runtime so far: 518 sec

### Epoch 105 ###
Train MSE: 0.09108
Train R2 (on path-augmented data): 0.9765
Best so far: epoch 97, MSE=0.08612, R²=0.9868, No improve
Runtime so far: 523 sec


⚠️  Detected divergence (loss explosion).
Stopping at epoch 106. Restoring best model from epoch 97 (MSE=0.08612, R²=0.9868)

Restored best MPS from epoch 97 (MSE=0.08612, R²=0.9868)
Saved TN-SHAP targets and t-nodes to poly10_D100_tnshap_targets.pt
Saved trained MPS to poly10_D100_mps.pt
Done.
